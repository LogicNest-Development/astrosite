---
import Layout from "../layouts/Layout.astro";
import { getCollection, renderMarkdown } from "astro:content";

const docs = await getCollection("legal");
const activeTitle = Astro.url.searchParams.get("doc") ?? docs[0]?.data.title;
const activeDoc = docs.find(d => d.data.title === activeTitle) ?? docs[0];
const compiled = activeDoc ? await renderMarkdown(activeDoc.body) : null;
---
<Layout title="Legal â€” LogicNest">
  <section class="container py-12">
    <div class="flex flex-wrap gap-2">
      {docs.map(d => (
        <a
          href={`/legal?doc=${encodeURIComponent(d.data.title)}`}
          class={`px-3 py-2 rounded-xl border border-white/10 transition ${activeDoc?.data.title === d.data.title ? "bg-white/10" : "hover:bg-white/5"}`}
        >{d.data.title}</a>
      ))}
    </div>

    <div class="card p-6 mt-6 prose prose-invert max-w-none">
      <article set:html={compiled?.content}></article>
    </div>
  </section>
</Layout>
