---
import nav from "../data/nav.json";
import { getCollection } from "astro:content";
const baseItems = (nav.items ?? []).filter((i) => i.enabled !== false);
const groups = await getCollection("product-groups", ({ data }) => data.enabled !== false && data.showInNav === true);
const groupLinks = groups
  .sort((a,b) => (a.data.order ?? 100) - (b.data.order ?? 100))
  .map(g => ({ key: `group-${g.slug}`, label: g.data.title, path: `/products/${g.slug}`, type: "page" }));
const items = [...baseItems, ...groupLinks];
const clientArea = nav.clientAreaUrl;
---
<header class="sticky top-0 z-40 border-b border-white/5 bg-bg/80 backdrop-blur">
  <div class="container-section flex h-16 items-center justify-between">
    <a href="/" class="flex items-center gap-3">
      <img src="/logo.png" alt="LogicNest Networks" class="h-8 w-8 rounded-xl shadow-ring" />
      <span class="text-white font-semibold">LogicNest Networks</span>
    </a>

    <nav class="hidden md:flex items-center gap-6">
      {items.map((l) => (
        <a
          class="nav-link"
          href={l.path}
          target={l.external ? '_blank' : undefined}
          rel={l.external ? 'noopener' : undefined}
        >
          {l.label}
        </a>
      ))}
    </nav>

    {clientArea && <a href={clientArea} class="btn-primary hidden md:inline-flex">Client Area</a>}
  </div>
</header>
