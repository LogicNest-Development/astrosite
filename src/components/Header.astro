---
import nav from "@data/nav.json";
const { clientAreaUrl } = nav;
const items = nav.items?.filter((i) => i.enabled !== false) ?? [];
---
<header class="sticky top-0 z-40 backdrop-blur bg-black/40 border-b border-white/10">
  <div class="container h-14 flex items-center justify-between">
    <a href="/" class="font-bold">LogicNest</a>

    <nav class="hidden md:flex items-center gap-2">
      {items.map((item) => (
        item.type === "section" ? (
          <details class="group relative">
            <summary class="cursor-pointer px-3 py-2 rounded-xl hover:bg-white/5">{item.label}</summary>
            <div class="absolute left-0 mt-2 w-[560px] p-4 card">
              <div class="grid grid-cols-2 gap-3">
                {(item.children ?? []).map((c) => (
                  <a href={c.path} class="px-3 py-2 rounded-lg hover:bg-white/5">{c.label}</a>
                ))}
              </div>
            </div>
          </details>
        ) : (
          <a
            href={item.path}
            class="px-3 py-2 rounded-xl hover:bg-white/5"
            target={item.external ? "_blank" : "_self"}
            rel={item.external ? "noopener noreferrer" : undefined}
          >
            {item.label}
          </a>
        )
      ))}
    </nav>

    <div class="flex items-center gap-2">
      {clientAreaUrl && (
        <a href={clientAreaUrl} class="px-3 py-2 rounded-xl border border-white/10 hover:bg-white/5">Client Area</a>
      )}
      <button class="md:hidden px-3 py-2 rounded-xl border border-white/10" onclick="document.getElementById('mnav').showModal()">Menu</button>
    </div>
  </div>

  <!-- mobile -->
  <dialog id="mnav" class="card w-[92vw] max-w-md p-4">
    <form method="dialog">
      <button class="absolute right-3 top-3 px-2 py-1 border rounded-lg border-white/10">âœ•</button>
    </form>
    <div class="mt-6 space-y-2">
      {items.map((item) => (
        item.type === "section" ? (
          <details>
            <summary class="px-3 py-2 rounded-lg hover:bg-white/5">{item.label}</summary>
            <div class="pl-3 py-2 space-y-1">
              {(item.children ?? []).map((c) => (
                <a href={c.path} class="block px-3 py-2 rounded hover:bg-white/5">{c.label}</a>
              ))}
            </div>
          </details>
        ) : (
          <a href={item.path} class="block px-3 py-2 rounded hover:bg-white/5">{item.label}</a>
        )
      ))}
    </div>
  </dialog>
</header>
